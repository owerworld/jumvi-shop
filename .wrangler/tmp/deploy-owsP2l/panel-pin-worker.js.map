{
  "version": 3,
  "sources": ["../../../auth/utils/db.js", "../../../auth/utils/crypto.js", "../../../auth/utils/token.js", "../../../auth/api/middleware.js", "../../../auth/api/session.js", "../../../auth/api/auth.js", "../../../auth/api/2fa.js", "../../../panel-pin-worker.js"],
  "sourceRoot": "/Users/ramo/Documents/New project/.wrangler/tmp/deploy-owsP2l",
  "sourcesContent": ["export async function dbGet(env, query, params = []) {\n  const result = await env.JUMVI_DB.prepare(query).bind(...params).first();\n  return result || null;\n}\n\nexport async function dbAll(env, query, params = []) {\n  const result = await env.JUMVI_DB.prepare(query).bind(...params).all();\n  return result.results || [];\n}\n\nexport async function dbRun(env, query, params = []) {\n  return env.JUMVI_DB.prepare(query).bind(...params).run();\n}\n", "const encoder = new TextEncoder();\n\nfunction toHex(buffer) {\n  return Array.from(new Uint8Array(buffer))\n    .map((b) => b.toString(16).padStart(2, \"0\"))\n    .join(\"\");\n}\n\nexport function randomId() {\n  if (crypto.randomUUID) return crypto.randomUUID();\n  const bytes = crypto.getRandomValues(new Uint8Array(16));\n  bytes[6] = (bytes[6] & 0x0f) | 0x40;\n  bytes[8] = (bytes[8] & 0x3f) | 0x80;\n  const hex = Array.from(bytes).map((b) => b.toString(16).padStart(2, \"0\"));\n  return `${hex.slice(0, 4).join(\"\")}-${hex.slice(4, 6).join(\"\")}-${hex.slice(6, 8).join(\"\")}-${hex.slice(8, 10).join(\"\")}-${hex.slice(10, 16).join(\"\")}`;\n}\n\nexport async function sha256Hex(input) {\n  const data = typeof input === \"string\" ? encoder.encode(input) : input;\n  const hash = await crypto.subtle.digest(\"SHA-256\", data);\n  return toHex(hash);\n}\n\n// NOTE: bcryptjs couldn't be installed in this offline environment.\n// This uses PBKDF2-HMAC-SHA256 (210k iterations) as a secure fallback.\nconst PBKDF2_ITER = 100000;\n\nexport async function hashPassword(password) {\n  const salt = crypto.getRandomValues(new Uint8Array(16));\n  const key = await crypto.subtle.importKey(\"raw\", encoder.encode(password), \"PBKDF2\", false, [\n    \"deriveBits\",\n  ]);\n  const bits = await crypto.subtle.deriveBits(\n    { name: \"PBKDF2\", salt, iterations: PBKDF2_ITER, hash: \"SHA-256\" },\n    key,\n    256\n  );\n  return `pbkdf2|${PBKDF2_ITER}|${toHex(salt)}|${toHex(bits)}`;\n}\n\nexport async function verifyPassword(password, stored) {\n  if (!stored?.startsWith(\"pbkdf2\")) return false;\n  const parts = stored.includes(\"|\") ? stored.split(\"|\") : stored.split(\"$\");\n  const [, iterStr, saltHex, hashHex] = parts;\n  const iterations = parseInt(iterStr, 10);\n  const salt = Uint8Array.from(saltHex.match(/.{1,2}/g).map((b) => parseInt(b, 16)));\n  const key = await crypto.subtle.importKey(\"raw\", encoder.encode(password), \"PBKDF2\", false, [\n    \"deriveBits\",\n  ]);\n  const bits = await crypto.subtle.deriveBits(\n    { name: \"PBKDF2\", salt, iterations, hash: \"SHA-256\" },\n    key,\n    256\n  );\n  return toHex(bits) === hashHex;\n}\n\nconst BASE32_ALPHABET = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567\";\n\nfunction base32Encode(bytes) {\n  let bits = \"\";\n  bytes.forEach((b) => (bits += b.toString(2).padStart(8, \"0\")));\n  let output = \"\";\n  for (let i = 0; i < bits.length; i += 5) {\n    const chunk = bits.slice(i, i + 5);\n    if (chunk.length < 5) output += BASE32_ALPHABET[parseInt(chunk.padEnd(5, \"0\"), 2)];\n    else output += BASE32_ALPHABET[parseInt(chunk, 2)];\n  }\n  return output;\n}\n\nfunction base32Decode(str) {\n  const cleaned = str.replace(/=+$/g, \"\").toUpperCase();\n  let bits = \"\";\n  for (const c of cleaned) {\n    const val = BASE32_ALPHABET.indexOf(c);\n    if (val === -1) continue;\n    bits += val.toString(2).padStart(5, \"0\");\n  }\n  const bytes = [];\n  for (let i = 0; i + 8 <= bits.length; i += 8) {\n    bytes.push(parseInt(bits.slice(i, i + 8), 2));\n  }\n  return new Uint8Array(bytes);\n}\n\nexport function generateTotpSecret() {\n  const bytes = crypto.getRandomValues(new Uint8Array(20));\n  return base32Encode(bytes);\n}\n\nasync function hmacSha1(keyBytes, counter) {\n  const key = await crypto.subtle.importKey(\"raw\", keyBytes, { name: \"HMAC\", hash: \"SHA-1\" }, false, [\n    \"sign\",\n  ]);\n  return crypto.subtle.sign(\"HMAC\", key, counter);\n}\n\nexport async function totpCode(secret, step = 30, digits = 6, timestamp = Date.now()) {\n  const key = base32Decode(secret);\n  const counter = Math.floor(timestamp / 1000 / step);\n  const buffer = new ArrayBuffer(8);\n  const view = new DataView(buffer);\n  view.setUint32(4, counter);\n  const hmac = new Uint8Array(await hmacSha1(key, buffer));\n  const offset = hmac[hmac.length - 1] & 0xf;\n  const code =\n    ((hmac[offset] & 0x7f) << 24) |\n    ((hmac[offset + 1] & 0xff) << 16) |\n    ((hmac[offset + 2] & 0xff) << 8) |\n    (hmac[offset + 3] & 0xff);\n  return String(code % 10 ** digits).padStart(digits, \"0\");\n}\n\nexport async function verifyTotp(secret, code, window = 1) {\n  const now = Date.now();\n  for (let w = -window; w <= window; w++) {\n    const candidate = await totpCode(secret, 30, 6, now + w * 30000);\n    if (candidate === code) return true;\n  }\n  return false;\n}\n\nexport function generateBackupCodes() {\n  const codes = [];\n  for (let i = 0; i < 6; i++) {\n    codes.push(Math.random().toString(36).slice(2, 8).toUpperCase());\n  }\n  return codes;\n}\n", "const encoder = new TextEncoder();\n\nfunction base64url(input) {\n  const bytes = input instanceof Uint8Array ? input : new Uint8Array(input);\n  let str = \"\";\n  bytes.forEach((b) => (str += String.fromCharCode(b)));\n  return btoa(str).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/g, \"\");\n}\n\nasync function hmacSha256(secret, data) {\n  const key = await crypto.subtle.importKey(\n    \"raw\",\n    encoder.encode(secret),\n    { name: \"HMAC\", hash: \"SHA-256\" },\n    false,\n    [\"sign\"]\n  );\n  return crypto.subtle.sign(\"HMAC\", key, encoder.encode(data));\n}\n\nexport async function signJwt(payload, secret, expiresInSeconds) {\n  const header = { alg: \"HS256\", typ: \"JWT\" };\n  const now = Math.floor(Date.now() / 1000);\n  const body = { ...payload, iat: now, exp: now + expiresInSeconds };\n\n  const encodedHeader = base64url(encoder.encode(JSON.stringify(header)));\n  const encodedPayload = base64url(encoder.encode(JSON.stringify(body)));\n  const unsigned = `${encodedHeader}.${encodedPayload}`;\n  const signature = await hmacSha256(secret, unsigned);\n  return `${unsigned}.${base64url(signature)}`;\n}\n\nexport async function verifyJwt(token, secret) {\n  if (!token) return null;\n  const [h, p, s] = token.split(\".\");\n  if (!h || !p || !s) return null;\n  const unsigned = `${h}.${p}`;\n  const expected = base64url(await hmacSha256(secret, unsigned));\n  if (expected !== s) return null;\n  const payload = JSON.parse(atob(p.replace(/-/g, \"+\").replace(/_/g, \"/\")));\n  if (payload.exp && Date.now() / 1000 > payload.exp) return null;\n  return payload;\n}\n", "import { verifyJwt } from \"../utils/token.js\";\nimport { dbAll, dbRun } from \"../utils/db.js\";\nimport { randomId } from \"../utils/crypto.js\";\n\nexport function parseCookies(request) {\n  const header = request.headers.get(\"Cookie\") || \"\";\n  return Object.fromEntries(\n    header.split(\";\").map((c) => {\n      const [k, ...v] = c.trim().split(\"=\");\n      return [k, decodeURIComponent(v.join(\"=\"))];\n    })\n  );\n}\n\nexport function clientIp(request) {\n  return request.headers.get(\"CF-Connecting-IP\") || request.headers.get(\"X-Forwarded-For\") || \"\";\n}\n\nexport async function requireAccess(request, env) {\n  const cookies = parseCookies(request);\n  const token = cookies.access_token;\n  const payload = await verifyJwt(token, env.JWT_SECRET);\n  return payload;\n}\n\nexport async function checkRateLimit(env, email, ip) {\n  const since = new Date(Date.now() - 15 * 60 * 1000).toISOString();\n  const rows = await dbAll(\n    env,\n    \"SELECT success FROM login_attempts WHERE (email = ? OR ip_address = ?) AND attempted_at > ?\",\n    [email, ip, since]\n  );\n  const fails = rows.filter((r) => r.success === 0).length;\n  return fails >= 5;\n}\n\nexport async function logAttempt(env, email, ip, success) {\n  await dbRun(\n    env,\n    \"INSERT INTO login_attempts (id, email, ip_address, success, attempted_at) VALUES (?, ?, ?, ?, ?)\",\n    [randomId(), email, ip, success ? 1 : 0, new Date().toISOString()]\n  );\n}\n", "import { dbRun, dbAll } from \"../utils/db.js\";\nimport { randomId, sha256Hex } from \"../utils/crypto.js\";\nimport { clientIp } from \"./middleware.js\";\n\nconst REFRESH_TTL = 30 * 24 * 60 * 60;\n\nasync function ensureSessionLimit(env, userId) {\n  const sessions = await dbAll(env, \"SELECT id, created_at FROM sessions WHERE user_id = ? ORDER BY created_at DESC\", [\n    userId,\n  ]);\n  if (sessions.length <= 3) return;\n  const toDelete = sessions.slice(3).map((s) => s.id);\n  for (const id of toDelete) {\n    await dbRun(env, \"DELETE FROM sessions WHERE id = ?\", [id]);\n  }\n}\n\nexport async function createSessionTokens(env, user, remember, request) {\n  const refreshRaw = `${randomId()}-${randomId()}`;\n  const refreshHash = await sha256Hex(refreshRaw + env.SESSION_SECRET);\n  const ttl = remember ? REFRESH_TTL : 24 * 60 * 60;\n  const expiresAt = new Date(Date.now() + ttl * 1000).toISOString();\n  await dbRun(\n    env,\n    \"INSERT INTO sessions (id, user_id, refresh_token, ip_address, user_agent, expires_at, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)\",\n    [\n      randomId(),\n      user.id,\n      refreshHash,\n      clientIp(request),\n      request.headers.get(\"User-Agent\") || \"\",\n      expiresAt,\n      new Date().toISOString(),\n    ]\n  );\n  await ensureSessionLimit(env, user.id);\n  return { refreshRaw, ttl };\n}\n", "import { dbGet, dbRun } from \"../utils/db.js\";\nimport { hashPassword, verifyPassword, randomId, sha256Hex, generateBackupCodes } from \"../utils/crypto.js\";\nimport { signJwt, verifyJwt } from \"../utils/token.js\";\nimport { parseCookies, clientIp, checkRateLimit, logAttempt } from \"./middleware.js\";\nimport { createSessionTokens } from \"./session.js\";\n\nconst ACCESS_TTL = 30 * 60;\nconst REFRESH_TTL = 30 * 24 * 60 * 60;\nconst REFRESH_TTL_SHORT = 24 * 60 * 60;\n\nfunction cookie(name, value, maxAge, domain) {\n  return `${name}=${encodeURIComponent(value)}; Path=/; HttpOnly; Secure; SameSite=Lax; Max-Age=${maxAge}; Domain=${domain}`;\n}\n\nfunction clearCookie(name, domain) {\n  return `${name}=; Path=/; HttpOnly; Secure; SameSite=Lax; Max-Age=0; Domain=${domain}`;\n}\n\nfunction passwordPolicy(password) {\n  return (\n    password.length >= 12 &&\n    /[A-Z]/.test(password) &&\n    /[a-z]/.test(password) &&\n    /[0-9]/.test(password) &&\n    /[^A-Za-z0-9]/.test(password)\n  );\n}\n\nasync function createSession(env, user, remember, request) {\n  return createSessionTokens(env, user, remember, request);\n}\n\nexport async function login(request, env) {\n  const body = await request.json().catch(() => ({}));\n  const email = (body.email || \"\").toLowerCase().trim();\n  const password = body.password || \"\";\n  const remember = body.remember !== false;\n  const ip = clientIp(request);\n\n  if (await checkRateLimit(env, email, ip)) {\n    return new Response(JSON.stringify({ error: \"Too many attempts\" }), { status: 429 });\n  }\n\n  const user = await dbGet(env, \"SELECT * FROM users WHERE email = ?\", [email]);\n  if (!user) {\n    await logAttempt(env, email, ip, false);\n    return new Response(JSON.stringify({ error: \"Invalid credentials\" }), { status: 401 });\n  }\n\n  const ok = await verifyPassword(password, user.password_hash);\n  if (!ok) {\n    await logAttempt(env, email, ip, false);\n    return new Response(JSON.stringify({ error: \"Invalid credentials\" }), { status: 401 });\n  }\n\n  await logAttempt(env, email, ip, true);\n  await dbRun(env, \"UPDATE users SET last_login = ? WHERE id = ?\", [new Date().toISOString(), user.id]);\n\n  const cookies = parseCookies(request);\n  const trusted = cookies.trusted_device;\n  const trustedDevices = user.trusted_devices ? JSON.parse(user.trusted_devices) : { trusted: [], backup: [] };\n  const trustedHashes = trustedDevices.trusted || [];\n  const trustedOk = trusted ? trustedHashes.includes(await sha256Hex(trusted + env.SESSION_SECRET)) : false;\n\n  if (user.totp_enabled && !trustedOk) {\n    const preToken = await signJwt({ sub: user.id, purpose: \"2fa\", remember }, env.JWT_SECRET, 10 * 60);\n    return new Response(JSON.stringify({ requires2fa: true, setup: false }), {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Set-Cookie\": cookie(\"pre_2fa\", preToken, 600, env.COOKIE_DOMAIN),\n      },\n    });\n  }\n\n  if (!user.totp_enabled) {\n    const preToken = await signJwt({ sub: user.id, purpose: \"2fa\", remember }, env.JWT_SECRET, 10 * 60);\n    return new Response(JSON.stringify({ requires2fa: true, setup: true }), {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Set-Cookie\": cookie(\"pre_2fa\", preToken, 600, env.COOKIE_DOMAIN),\n      },\n    });\n  }\n\n  const access = await signJwt({ sub: user.id, email: user.email }, env.JWT_SECRET, ACCESS_TTL);\n  const session = await createSession(env, user, remember, request);\n  return new Response(JSON.stringify({ ok: true }), {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Set-Cookie\": [\n        cookie(\"access_token\", access, ACCESS_TTL, env.COOKIE_DOMAIN),\n        cookie(\"refresh_token\", session.refreshRaw, session.ttl, env.COOKIE_DOMAIN),\n      ].join(\", \"),\n    },\n  });\n}\n\nexport async function refresh(request, env) {\n  const cookies = parseCookies(request);\n  const refreshToken = cookies.refresh_token;\n  if (!refreshToken) return new Response(JSON.stringify({ error: \"No refresh\" }), { status: 401 });\n  const hash = await sha256Hex(refreshToken + env.SESSION_SECRET);\n  const session = await dbGet(env, \"SELECT * FROM sessions WHERE refresh_token = ?\", [hash]);\n  if (!session) return new Response(JSON.stringify({ error: \"Invalid refresh\" }), { status: 401 });\n  if (new Date(session.expires_at).getTime() < Date.now()) {\n    await dbRun(env, \"DELETE FROM sessions WHERE id = ?\", [session.id]);\n    return new Response(JSON.stringify({ error: \"Expired\" }), { status: 401 });\n  }\n\n  const user = await dbGet(env, \"SELECT * FROM users WHERE id = ?\", [session.user_id]);\n  if (!user) return new Response(JSON.stringify({ error: \"Invalid user\" }), { status: 401 });\n  const access = await signJwt({ sub: user.id, email: user.email }, env.JWT_SECRET, ACCESS_TTL);\n  return new Response(JSON.stringify({ ok: true }), {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Set-Cookie\": cookie(\"access_token\", access, ACCESS_TTL, env.COOKIE_DOMAIN),\n    },\n  });\n}\n\nexport async function logout(request, env) {\n  const cookies = parseCookies(request);\n  const refreshToken = cookies.refresh_token;\n  if (refreshToken) {\n    const hash = await sha256Hex(refreshToken + env.SESSION_SECRET);\n    await dbRun(env, \"DELETE FROM sessions WHERE refresh_token = ?\", [hash]);\n  }\n  return new Response(JSON.stringify({ ok: true }), {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Set-Cookie\": [\n        clearCookie(\"access_token\", env.COOKIE_DOMAIN),\n        clearCookie(\"refresh_token\", env.COOKIE_DOMAIN),\n        clearCookie(\"trusted_device\", env.COOKIE_DOMAIN),\n        clearCookie(\"pre_2fa\", env.COOKIE_DOMAIN),\n      ].join(\", \"),\n    },\n  });\n}\n\nexport async function me(request, env) {\n  const cookies = parseCookies(request);\n  const token = cookies.access_token;\n  const payload = await verifyJwt(token, env.JWT_SECRET);\n  if (!payload) return new Response(JSON.stringify({ error: \"Unauthorized\" }), { status: 401 });\n  return new Response(JSON.stringify({ id: payload.sub, email: payload.email }), {\n    headers: { \"Content-Type\": \"application/json\" },\n  });\n}\n\nexport async function forgotPassword(request, env) {\n  const body = await request.json().catch(() => ({}));\n  const email = (body.email || \"\").toLowerCase().trim();\n  const user = await dbGet(env, \"SELECT * FROM users WHERE email = ?\", [email]);\n  if (!user) return new Response(JSON.stringify({ ok: true }), { headers: { \"Content-Type\": \"application/json\" } });\n  const resetToken = `${randomId()}${randomId()}`;\n  const resetHash = await sha256Hex(resetToken + env.SESSION_SECRET);\n  const trusted = user.trusted_devices ? JSON.parse(user.trusted_devices) : { trusted: [], backup: [] };\n  trusted.reset = { hash: resetHash, exp: Date.now() + 60 * 60 * 1000 };\n  await dbRun(env, \"UPDATE users SET trusted_devices = ? WHERE id = ?\", [\n    JSON.stringify(trusted),\n    user.id,\n  ]);\n  return new Response(JSON.stringify({ ok: true, resetToken }), {\n    headers: { \"Content-Type\": \"application/json\" },\n  });\n}\n\nexport async function resetPassword(request, env) {\n  const body = await request.json().catch(() => ({}));\n  const email = (body.email || \"\").toLowerCase().trim();\n  const token = body.token || \"\";\n  const newPassword = body.newPassword || \"\";\n  if (!passwordPolicy(newPassword)) {\n    return new Response(JSON.stringify({ error: \"Weak password\" }), { status: 400 });\n  }\n  const user = await dbGet(env, \"SELECT * FROM users WHERE email = ?\", [email]);\n  if (!user) return new Response(JSON.stringify({ error: \"Invalid\" }), { status: 400 });\n  const trusted = user.trusted_devices ? JSON.parse(user.trusted_devices) : {};\n  const reset = trusted.reset;\n  if (!reset || reset.exp < Date.now()) return new Response(JSON.stringify({ error: \"Expired\" }), { status: 400 });\n  const hash = await sha256Hex(token + env.SESSION_SECRET);\n  if (hash !== reset.hash) return new Response(JSON.stringify({ error: \"Invalid\" }), { status: 400 });\n  const pwHash = await hashPassword(newPassword);\n  delete trusted.reset;\n  await dbRun(env, \"UPDATE users SET password_hash = ?, trusted_devices = ? WHERE id = ?\", [\n    pwHash,\n    JSON.stringify(trusted),\n    user.id,\n  ]);\n  return new Response(JSON.stringify({ ok: true }), { headers: { \"Content-Type\": \"application/json\" } });\n}\n\nexport async function bootstrapUser(env, email, password) {\n  const existing = await dbGet(env, \"SELECT id FROM users WHERE email = ?\", [email]);\n  if (existing) return existing.id;\n  const id = randomId();\n  const pwHash = await hashPassword(password);\n  await dbRun(env, \"INSERT INTO users (id, email, password_hash, created_at, trusted_devices) VALUES (?, ?, ?, ?, ?)\", [\n    id,\n    email,\n    pwHash,\n    new Date().toISOString(),\n    JSON.stringify({ trusted: [], backup: [] }),\n  ]);\n  return id;\n}\n", "import { dbGet, dbRun } from \"../utils/db.js\";\nimport {\n  generateTotpSecret,\n  verifyTotp,\n  generateBackupCodes,\n  sha256Hex,\n  randomId,\n} from \"../utils/crypto.js\";\nimport { verifyJwt, signJwt } from \"../utils/token.js\";\nimport { parseCookies } from \"./middleware.js\";\nimport { createSessionTokens } from \"./session.js\";\n\nconst ACCESS_TTL = 30 * 60;\n\nfunction cookie(name, value, maxAge, domain) {\n  return `${name}=${encodeURIComponent(value)}; Path=/; HttpOnly; Secure; SameSite=Lax; Max-Age=${maxAge}; Domain=${domain}`;\n}\n\nexport async function setup2fa(request, env) {\n  const cookies = parseCookies(request);\n  const pre = cookies.pre_2fa;\n  const payload = await verifyJwt(pre, env.JWT_SECRET);\n  if (!payload || payload.purpose !== \"2fa\") {\n    return new Response(JSON.stringify({ error: \"Unauthorized\" }), { status: 401 });\n  }\n  const user = await dbGet(env, \"SELECT * FROM users WHERE id = ?\", [payload.sub]);\n  if (!user) return new Response(JSON.stringify({ error: \"Unauthorized\" }), { status: 401 });\n\n  if (user.totp_enabled) {\n    return new Response(JSON.stringify({ error: \"already_enabled\" }), { status: 409 });\n  }\n\n  const secret = user.totp_secret || generateTotpSecret();\n  const backupCodes = generateBackupCodes();\n  const backupHashes = await Promise.all(\n    backupCodes.map((c) => sha256Hex(c + env.SESSION_SECRET))\n  );\n  let trusted = { trusted: [], backup: [] };\n  if (user.trusted_devices) {\n    try { trusted = JSON.parse(user.trusted_devices); } catch {}\n  }\n  trusted.backup = backupHashes;\n\n  await dbRun(env, \"UPDATE users SET totp_secret = ?, trusted_devices = ? WHERE id = ?\", [\n    secret,\n    JSON.stringify(trusted),\n    user.id,\n  ]);\n\n  const otpauth = `otpauth://totp/JUMVI:${encodeURIComponent(user.email)}?secret=${secret}&issuer=JUMVI&digits=6&period=30`;\n  return new Response(JSON.stringify({ secret, otpauth, backupCodes }), {\n    headers: { \"Content-Type\": \"application/json\" },\n  });\n}\n\nexport async function verify2fa(request, env) {\n  const cookies = parseCookies(request);\n  const pre = cookies.pre_2fa;\n  const payload = await verifyJwt(pre, env.JWT_SECRET);\n  if (!payload || payload.purpose !== \"2fa\") {\n    return new Response(JSON.stringify({ error: \"Unauthorized\" }), { status: 401 });\n  }\n  const body = await request.json().catch(() => ({}));\n  const code = (body.code || \"\").toString().trim();\n  const trustDevice = body.trustDevice === true;\n\n  const user = await dbGet(env, \"SELECT * FROM users WHERE id = ?\", [payload.sub]);\n  if (!user || !user.totp_secret) return new Response(JSON.stringify({ error: \"Unauthorized\" }), { status: 401 });\n\n  let verified = await verifyTotp(user.totp_secret, code);\n  const trusted = user.trusted_devices ? JSON.parse(user.trusted_devices) : { trusted: [], backup: [] };\n  if (!verified && trusted.backup?.length) {\n    const hash = await sha256Hex(code + env.SESSION_SECRET);\n    if (trusted.backup.includes(hash)) {\n      verified = true;\n      trusted.backup = trusted.backup.filter((h) => h !== hash);\n    }\n  }\n\n  if (!verified) return new Response(JSON.stringify({ error: \"Invalid code\" }), { status: 401 });\n\n  if (!user.totp_enabled) {\n    await dbRun(env, \"UPDATE users SET totp_enabled = 1, trusted_devices = ? WHERE id = ?\", [\n      JSON.stringify(trusted),\n      user.id,\n    ]);\n  } else {\n    await dbRun(env, \"UPDATE users SET trusted_devices = ? WHERE id = ?\", [JSON.stringify(trusted), user.id]);\n  }\n\n  const access = await signJwt({ sub: user.id, email: user.email }, env.JWT_SECRET, ACCESS_TTL);\n  const { refreshRaw, ttl } = await createSessionTokens(env, user, payload.remember !== false, request);\n\n  const setCookies = [cookie(\"access_token\", access, ACCESS_TTL, env.COOKIE_DOMAIN)];\n  setCookies.push(cookie(\"refresh_token\", refreshRaw, ttl, env.COOKIE_DOMAIN));\n\n  if (trustDevice) {\n    const deviceToken = `${randomId()}${randomId()}`;\n    const hash = await sha256Hex(deviceToken + env.SESSION_SECRET);\n    trusted.trusted = trusted.trusted || [];\n    trusted.trusted.push(hash);\n    await dbRun(env, \"UPDATE users SET trusted_devices = ? WHERE id = ?\", [JSON.stringify(trusted), user.id]);\n    setCookies.push(cookie(\"trusted_device\", deviceToken, 30 * 24 * 60 * 60, env.COOKIE_DOMAIN));\n  }\n\n  return new Response(JSON.stringify({ ok: true }), {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Set-Cookie\": setCookies.join(\", \"),\n    },\n  });\n}\n", "import { login, refresh, logout, me, forgotPassword, resetPassword } from \"./auth/api/auth.js\";\nimport { setup2fa, verify2fa } from \"./auth/api/2fa.js\";\nimport { requireAccess, parseCookies, clientIp } from \"./auth/api/middleware.js\";\nimport { verifyJwt } from \"./auth/utils/token.js\";\nimport { dbRun } from \"./auth/utils/db.js\";\n\nconst PAGES_ORIGIN = \"https://jumvi-panel.pages.dev\";\nconst INDEX_KEY = \"_index.json\";\nconst STATE_KEY = \"_state.json\";\nconst ALLOWED_MIME = [\"application/pdf\", \"image/png\", \"image/jpeg\", \"video/mp4\", \"video/quicktime\"];\nconst MAX_UPLOAD_SIZE = 20 * 1024 * 1024;\nconst MAX_VIDEO_SIZE = 200 * 1024 * 1024;\nconst FILE_TOKEN_TTL = 5 * 60 * 1000;\nconst ENCRYPTION_MAX_BYTES = 25 * 1024 * 1024;\nconst GOLD_OUNCE_GRAMS = 31.1035;\nconst QUARTER_GOLD_GRAMS = 1.75;\nconst QUARTER_GOLD_PURITY = 22 / 24;\nconst SCRIPT_SRI_TARGETS = [\n  \"https://cdn.jsdelivr.net/npm/axios@1.6.8/dist/axios.min.js\",\n  \"https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js\",\n  \"https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js\"\n];\nconst CSP_POLICY = [\n  \"default-src 'self'\",\n  \"script-src 'self' https://cdn.jsdelivr.net\",\n  \"style-src 'self'\",\n  \"img-src 'self' data: blob: https://api.qrserver.com\",\n  \"font-src 'self'\",\n  \"connect-src 'self'\",\n  \"media-src 'self' blob:\",\n  \"object-src 'none'\",\n  \"base-uri 'self'\",\n  \"frame-ancestors 'none'\",\n  \"form-action 'self'\",\n  \"upgrade-insecure-requests\",\n  \"report-uri /api/csp-report\",\n  \"report-to csp-endpoint\"\n].join(\"; \");\nconst SECURITY_HEADERS = {\n  \"Strict-Transport-Security\": \"max-age=86400; includeSubDomains\",\n  \"X-Frame-Options\": \"DENY\",\n  \"X-Content-Type-Options\": \"nosniff\",\n  \"Referrer-Policy\": \"strict-origin-when-cross-origin\",\n  \"Permissions-Policy\": \"geolocation=(), microphone=(), camera=()\",\n  \"Content-Security-Policy\": CSP_POLICY,\n  \"Report-To\": JSON.stringify({\n    group: \"csp-endpoint\",\n    max_age: 86400,\n    endpoints: [{ url: \"https://say23.jumvi.co/api/csp-report\" }]\n  })\n};\n\nlet auditReady = false;\nlet encKeyPromise = null;\nconst sriCache = new Map();\n\nfunction escapeRegExp(value) {\n  return value.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\n\nasync function getSriHash(url) {\n  if (sriCache.has(url)) return sriCache.get(url);\n  try {\n    const res = await fetch(url);\n    if (!res.ok) return null;\n    const buffer = await res.arrayBuffer();\n    const hash = await crypto.subtle.digest(\"SHA-384\", buffer);\n    const b64 = btoa(String.fromCharCode(...new Uint8Array(hash)));\n    const integrity = `sha384-${b64}`;\n    sriCache.set(url, integrity);\n    return integrity;\n  } catch {\n    return null;\n  }\n}\n\nasync function injectSri(html) {\n  let output = html;\n  for (const src of SCRIPT_SRI_TARGETS) {\n    const integrity = await getSriHash(src);\n    if (!integrity) continue;\n    const escaped = escapeRegExp(src);\n    const tagRegex = new RegExp(`<script\\\\b([^>]*?)src=[\"']${escaped}[\"']([^>]*)>`, \"gi\");\n    output = output.replace(tagRegex, (match) => {\n      if (/\\bintegrity=/.test(match)) return match;\n      let extra = ` integrity=\"${integrity}\"`;\n      if (!/\\bcrossorigin=/.test(match)) {\n        extra += ` crossorigin=\"anonymous\"`;\n      }\n      return match.replace(/>$/, `${extra}>`);\n    });\n  }\n  return output;\n}\n\nasync function applySecurityHeaders(response) {\n  const headers = new Headers(response.headers);\n  for (const [key, value] of Object.entries(SECURITY_HEADERS)) {\n    headers.set(key, value);\n  }\n  const contentType = headers.get(\"Content-Type\") || \"\";\n  if (contentType.includes(\"text/html\")) {\n    const html = await response.text();\n    const withSri = await injectSri(html);\n    return new Response(withSri, {\n      status: response.status,\n      statusText: response.statusText,\n      headers\n    });\n  }\n  return new Response(response.body, {\n    status: response.status,\n    statusText: response.statusText,\n    headers\n  });\n}\n\nasync function readIndex(env) {\n  const obj = await env.PANEL_FILES.get(INDEX_KEY);\n  if (!obj) return [];\n  try {\n    const text = await obj.text();\n    const data = JSON.parse(text);\n    return Array.isArray(data) ? data : [];\n  } catch {\n    return [];\n  }\n}\n\nasync function writeIndex(env, items) {\n  const body = JSON.stringify(items);\n  await env.PANEL_FILES.put(INDEX_KEY, body, {\n    httpMetadata: { contentType: \"application/json\" }\n  });\n}\n\nfunction jsonResponse(body, status = 200) {\n  return new Response(JSON.stringify(body), {\n    status,\n    headers: {\n      \"Content-Type\": \"application/json; charset=utf-8\",\n      \"Cache-Control\": \"private, max-age=0, no-store\",\n      \"Vary\": \"Cookie\",\n      ...SECURITY_HEADERS\n    }\n  });\n}\n\nfunction sanitizeName(name) {\n  return name.replace(/[^a-zA-Z0-9._-]/g, \"_\");\n}\n\nfunction mimeFromName(name = \"\") {\n  const lower = name.toLowerCase();\n  if (lower.endsWith(\".pdf\")) return \"application/pdf\";\n  if (lower.endsWith(\".png\")) return \"image/png\";\n  if (lower.endsWith(\".jpg\") || lower.endsWith(\".jpeg\")) return \"image/jpeg\";\n  if (lower.endsWith(\".mp4\")) return \"video/mp4\";\n  if (lower.endsWith(\".mov\")) return \"video/quicktime\";\n  return \"\";\n}\n\nfunction base64UrlEncode(bytes) {\n  return btoa(String.fromCharCode(...bytes))\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\")\n    .replace(/=+$/g, \"\");\n}\n\nfunction base64UrlDecode(str) {\n  const pad = str.padEnd(str.length + (4 - (str.length % 4 || 4)), \"=\");\n  const normalized = pad.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  const binary = atob(normalized);\n  return Uint8Array.from(binary, (c) => c.charCodeAt(0));\n}\n\nasync function signPayload(payload, env) {\n  const enc = new TextEncoder();\n  const key = await crypto.subtle.importKey(\n    \"raw\",\n    enc.encode(env.SESSION_SECRET),\n    { name: \"HMAC\", hash: \"SHA-256\" },\n    false,\n    [\"sign\"]\n  );\n  const data = enc.encode(payload);\n  const sig = new Uint8Array(await crypto.subtle.sign(\"HMAC\", key, data));\n  return base64UrlEncode(sig);\n}\n\nasync function verifySignature(payload, signature, env) {\n  const enc = new TextEncoder();\n  const key = await crypto.subtle.importKey(\n    \"raw\",\n    enc.encode(env.SESSION_SECRET),\n    { name: \"HMAC\", hash: \"SHA-256\" },\n    false,\n    [\"verify\"]\n  );\n  const sigBytes = base64UrlDecode(signature);\n  return crypto.subtle.verify(\"HMAC\", key, sigBytes, enc.encode(payload));\n}\n\nasync function createFileToken(payload, env) {\n  const body = JSON.stringify(payload);\n  const encoded = base64UrlEncode(new TextEncoder().encode(body));\n  const signature = await signPayload(encoded, env);\n  return `${encoded}.${signature}`;\n}\n\nasync function verifyFileToken(token, env) {\n  const [encoded, signature] = token.split(\".\");\n  if (!encoded || !signature) return null;\n  const ok = await verifySignature(encoded, signature, env);\n  if (!ok) return null;\n  const decoded = new TextDecoder().decode(base64UrlDecode(encoded));\n  const payload = JSON.parse(decoded);\n  if (!payload?.exp || Date.now() > payload.exp) return null;\n  return payload;\n}\n\nasync function ensureAuditTable(env) {\n  if (auditReady) return;\n  await dbRun(\n    env,\n    `CREATE TABLE IF NOT EXISTS file_access_logs (\n      id TEXT PRIMARY KEY,\n      user_id TEXT,\n      file_key TEXT,\n      action TEXT,\n      ip_address TEXT,\n      user_agent TEXT,\n      via_token INTEGER,\n      created_at TEXT\n    )`\n  );\n  auditReady = true;\n}\n\nasync function logFileAccess(env, info) {\n  try {\n    await ensureAuditTable(env);\n    await dbRun(\n      env,\n      \"INSERT INTO file_access_logs (id, user_id, file_key, action, ip_address, user_agent, via_token, created_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?)\",\n      [\n        crypto.randomUUID(),\n        info.userId || null,\n        info.key,\n        info.action,\n        info.ip || \"\",\n        info.ua || \"\",\n        info.viaToken ? 1 : 0,\n        new Date().toISOString(),\n      ]\n    );\n  } catch {}\n}\n\nfunction parseAllowlist(env) {\n  const raw = env.ALLOW_IPS || \"\";\n  return raw.split(\",\").map((v) => v.trim()).filter(Boolean);\n}\n\nfunction pinRequired(env) {\n  return !!env.FILE_PIN;\n}\n\nfunction verifyPin(request, env) {\n  if (!pinRequired(env)) return true;\n  const headerPin = request.headers.get(\"X-File-Pin\");\n  const url = new URL(request.url);\n  const queryPin = url.searchParams.get(\"pin\");\n  const pin = headerPin || queryPin || \"\";\n  return pin && pin === env.FILE_PIN;\n}\n\nasync function getEncryptionKey(env) {\n  if (!env.FILE_ENC_KEY) return null;\n  if (!encKeyPromise) {\n    encKeyPromise = (async () => {\n      const raw = Uint8Array.from(atob(env.FILE_ENC_KEY), (c) => c.charCodeAt(0));\n      return crypto.subtle.importKey(\"raw\", raw, { name: \"AES-GCM\" }, false, [\"encrypt\", \"decrypt\"]);\n    })();\n  }\n  return encKeyPromise;\n}\n\nasync function encryptBuffer(buffer, env) {\n  const key = await getEncryptionKey(env);\n  if (!key) return { buffer, iv: null, encrypted: false };\n  const iv = crypto.getRandomValues(new Uint8Array(12));\n  const encrypted = await crypto.subtle.encrypt({ name: \"AES-GCM\", iv }, key, buffer);\n  return { buffer: encrypted, iv, encrypted: true };\n}\n\nasync function decryptBuffer(buffer, iv, env) {\n  const key = await getEncryptionKey(env);\n  if (!key) return buffer;\n  return crypto.subtle.decrypt({ name: \"AES-GCM\", iv }, key, buffer);\n}\n\nasync function safe(handler, label) {\n  try {\n    return await handler();\n  } catch (err) {\n    const message = err instanceof Error ? err.message : String(err);\n    return jsonResponse({ error: `auth_${label}_error`, message }, 500);\n  }\n}\n\nexport default {\n  async fetch(request, env) {\n    const url = new URL(request.url);\n    const forwardedProto = request.headers.get(\"x-forwarded-proto\");\n    const isHttp = url.protocol === \"http:\" || forwardedProto === \"http\";\n    if (isHttp) {\n      const httpsUrl = `https://${url.host}${url.pathname}${url.search}`;\n      return applySecurityHeaders(Response.redirect(httpsUrl, 301));\n    }\n\n    if (url.pathname === \"/api/csp-report\" && request.method === \"POST\") {\n      try {\n        const payload = await request.text();\n        console.warn(\"csp-report\", payload);\n      } catch {}\n      return applySecurityHeaders(new Response(null, { status: 204 }));\n    }\n\n    // Auth pages\n    if (url.pathname === \"/auth\" || url.pathname === \"/auth/\") {\n      return applySecurityHeaders(Response.redirect(`${url.origin}/auth/login`, 302));\n    }\n    if (url.pathname.startsWith(\"/auth\")) {\n      const pageMap = {\n        \"/auth/login\": \"/auth/pages/login\",\n        \"/auth/setup-2fa\": \"/auth/pages/setup-2fa\",\n        \"/auth/forgot-password\": \"/auth/pages/forgot-password\"\n      };\n      const target = pageMap[url.pathname] || url.pathname;\n      const pageRes = await fetch(new Request(PAGES_ORIGIN + target, request));\n      return applySecurityHeaders(pageRes);\n    }\n\n    // Auth APIs\n    if (url.pathname.startsWith(\"/api/auth\")) {\n      if (url.pathname === \"/api/auth/login\" && request.method === \"POST\")\n        return safe(() => login(request, env), \"login\");\n      if (url.pathname === \"/api/auth/verify-2fa\" && request.method === \"POST\")\n        return safe(() => verify2fa(request, env), \"verify2fa\");\n      if (url.pathname === \"/api/auth/setup-2fa\" && request.method === \"POST\")\n        return safe(() => setup2fa(request, env), \"setup2fa\");\n      if (url.pathname === \"/api/auth/refresh\" && request.method === \"POST\")\n        return safe(() => refresh(request, env), \"refresh\");\n      if (url.pathname === \"/api/auth/logout\" && request.method === \"POST\")\n        return safe(() => logout(request, env), \"logout\");\n      if (url.pathname === \"/api/auth/me\" && request.method === \"GET\")\n        return safe(() => me(request, env), \"me\");\n      if (url.pathname === \"/api/auth/forgot-password\" && request.method === \"POST\")\n        return safe(() => forgotPassword(request, env), \"forgot\");\n      if (url.pathname === \"/api/auth/reset-password\" && request.method === \"POST\")\n        return safe(() => resetPassword(request, env), \"reset\");\n      return jsonResponse({ error: \"Not found\" }, 404);\n    }\n\n    const needsAuth = url.pathname.startsWith(\"/panel\");\n    if (needsAuth) {\n      const payload = await requireAccess(request, env);\n      if (!payload) {\n        if (url.pathname.startsWith(\"/panel/api\")) return jsonResponse({ error: \"Unauthorized\" }, 401);\n        return applySecurityHeaders(Response.redirect(`${url.origin}/auth/login`, 302));\n      }\n    }\n\n    if (!url.pathname.startsWith(\"/panel\")) {\n      const passthrough = await fetch(request);\n      return applySecurityHeaders(passthrough);\n    }\n\n    if (url.pathname.startsWith(\"/panel/api\")) {\n\n      if (url.pathname === \"/panel/api/upload\" && request.method === \"POST\") {\n        const form = await request.formData();\n        const file = form.get(\"file\");\n        if (!file || typeof file === \"string\") {\n          return jsonResponse({ error: \"Missing file\" }, 400);\n        }\n\n        const category = (form.get(\"category\") || \"\").toString().trim();\n        const relatedId = (form.get(\"relatedId\") || \"\").toString();\n        const safeName = sanitizeName(file.name || \"file.pdf\");\n        const key = `${Date.now()}-${Math.random().toString(36).slice(2, 10)}-${safeName}`;\n\n        const contentType = file.type || mimeFromName(file.name) || \"application/pdf\";\n        if (!ALLOWED_MIME.includes(contentType)) {\n          return jsonResponse({ error: \"Invalid file type\" }, 400);\n        }\n        const maxSize = contentType.startsWith(\"video/\") ? MAX_VIDEO_SIZE : MAX_UPLOAD_SIZE;\n        if (file.size > maxSize) {\n          return jsonResponse({ error: \"File too large\" }, 400);\n        }\n        const storedAt = new Date().toISOString();\n        let bodyToStore = file.stream();\n        let meta = {\n          name: file.name || safeName,\n          category,\n          relatedId,\n          date: storedAt,\n          enc: \"0\",\n          origType: contentType\n        };\n\n        if (!contentType.startsWith(\"video/\") && file.size <= ENCRYPTION_MAX_BYTES) {\n          const buffer = await file.arrayBuffer();\n          const { buffer: encrypted, iv, encrypted: ok } = await encryptBuffer(buffer, env);\n          if (ok) {\n            bodyToStore = encrypted;\n            meta = {\n              ...meta,\n              enc: \"1\",\n              iv: base64UrlEncode(new Uint8Array(iv)),\n            };\n          }\n        }\n\n        await env.PANEL_FILES.put(key, bodyToStore, {\n          httpMetadata: { contentType },\n          customMetadata: meta\n        });\n\n        const index = await readIndex(env);\n        index.push({\n          key,\n          name: file.name || safeName,\n          type: contentType,\n          size: file.size || 0,\n          category,\n          relatedId,\n          date: storedAt\n        });\n        await writeIndex(env, index);\n\n        return jsonResponse({ key });\n      }\n\n      if (url.pathname === \"/panel/api/list\" && request.method === \"GET\") {\n        const index = await readIndex(env);\n        return jsonResponse(index);\n      }\n\n      if (url.pathname === \"/panel/api/fx\" && request.method === \"GET\") {\n        const date = url.searchParams.get(\"date\");\n        if (!date) return jsonResponse({ error: \"Missing date\" }, 400);\n        const fxRes = await fetch(`https://api.frankfurter.app/${encodeURIComponent(date)}?from=TRY&to=USD`);\n        if (!fxRes.ok) return jsonResponse({ error: \"FX failed\" }, 502);\n        const data = await fxRes.json();\n        const rate = Number(data?.rates?.USD);\n        if (!Number.isFinite(rate) || rate <= 0) return jsonResponse({ error: \"FX invalid\" }, 502);\n        return jsonResponse({ rate, date });\n      }\n\n      if (url.pathname === \"/panel/api/gold\" && request.method === \"GET\") {\n        const tryKapalicarsi = async () => {\n          const goldRes = await fetch(\"https://kapalicarsi.apiluna.org/\", {\n            headers: { \"User-Agent\": \"jumvi-panel/1.0\" }\n          });\n          if (!goldRes.ok) return null;\n          const list = await goldRes.json().catch(() => null);\n          if (!Array.isArray(list)) return null;\n          const item = list.find((row) => row?.code === \"CEYREK_YENI\") || list.find((row) => row?.code === \"CEYREK_ESKI\");\n          if (!item) return null;\n          const quarterTry = Number(String(item.satis || item.alis || \"0\").replace(\",\", \".\"));\n          if (!Number.isFinite(quarterTry) || quarterTry <= 0) return null;\n          return { quarterTry };\n        };\n\n        const cap = await tryKapalicarsi();\n        if (cap?.quarterTry) {\n          const fxRes = await fetch(\"https://api.frankfurter.app/latest?from=TRY&to=USD\");\n          if (!fxRes.ok) return jsonResponse({ error: \"fx_failed\" }, 502);\n          const fxData = await fxRes.json().catch(() => null);\n          const rate = Number(fxData?.rates?.USD);\n          if (!Number.isFinite(rate) || rate <= 0) return jsonResponse({ error: \"fx_failed\" }, 502);\n          const quarterUsd = cap.quarterTry * rate;\n          return jsonResponse({\n            quarterTry: Number(cap.quarterTry.toFixed(2)),\n            quarterUsd: Number(quarterUsd.toFixed(2)),\n            fxRate: rate,\n            updatedAt: new Date().toISOString(),\n            source: \"kapalicarsi\"\n          });\n        }\n\n        const key = env.METALS_DEV_KEY;\n        if (!key) return jsonResponse({ error: \"gold_failed\" }, 502);\n        const metalRes = await fetch(\n          `https://api.metals.dev/v1/latest?api_key=${encodeURIComponent(key)}&currency=USD&unit=toz`\n        );\n        if (!metalRes.ok) return jsonResponse({ error: \"gold_failed\" }, 502);\n        const metalData = await metalRes.json().catch(() => null);\n        if (metalData?.status !== \"success\") return jsonResponse({ error: \"gold_invalid\" }, 502);\n        const ounceUsd = Number(metalData?.metals?.gold);\n        if (!Number.isFinite(ounceUsd) || ounceUsd <= 0) return jsonResponse({ error: \"gold_invalid\" }, 502);\n        const quarterUsd = (ounceUsd / GOLD_OUNCE_GRAMS) * QUARTER_GOLD_GRAMS * QUARTER_GOLD_PURITY;\n        const usdTryRes = await fetch(\"https://api.frankfurter.app/latest?from=USD&to=TRY\");\n        if (!usdTryRes.ok) return jsonResponse({ error: \"fx_failed\" }, 502);\n        const usdTryData = await usdTryRes.json().catch(() => null);\n        const usdTry = Number(usdTryData?.rates?.TRY);\n        if (!Number.isFinite(usdTry) || usdTry <= 0) return jsonResponse({ error: \"fx_failed\" }, 502);\n        const quarterTry = quarterUsd * usdTry;\n        return jsonResponse({\n          quarterTry: Number(quarterTry.toFixed(2)),\n          quarterUsd: Number(quarterUsd.toFixed(2)),\n          fxRate: usdTry,\n          updatedAt: new Date().toISOString(),\n          source: \"spot\"\n        });\n      }\n\n      if (url.pathname === \"/panel/api/state\" && request.method === \"GET\") {\n        const obj = await env.PANEL_FILES.get(STATE_KEY);\n        if (!obj) return jsonResponse({ state: null });\n        try {\n          const text = await obj.text();\n          const data = JSON.parse(text);\n          return jsonResponse({ state: data });\n        } catch {\n          return jsonResponse({ state: null });\n        }\n      }\n\n      if (url.pathname === \"/panel/api/state\" && request.method === \"PUT\") {\n        const body = await request.json().catch(() => null);\n        if (!body || typeof body !== \"object\") {\n          return jsonResponse({ error: \"Invalid body\" }, 400);\n        }\n        await env.PANEL_FILES.put(STATE_KEY, JSON.stringify(body), {\n          httpMetadata: { contentType: \"application/json\" }\n        });\n        return jsonResponse({ ok: true });\n      }\n\n      if (url.pathname.startsWith(\"/panel/api/file-url/\") && request.method === \"GET\") {\n        const key = decodeURIComponent(url.pathname.replace(\"/panel/api/file-url/\", \"\"));\n        const payload = await requireAccess(request, env);\n        if (!payload) return jsonResponse({ error: \"Unauthorized\" }, 401);\n        if (!verifyPin(request, env)) return jsonResponse({ error: \"pin_required\" }, 403);\n        const download = url.searchParams.get(\"download\") === \"1\";\n        const token = await createFileToken(\n          { key, exp: Date.now() + FILE_TOKEN_TTL, download, pin: pinRequired(env) ? true : false },\n          env\n        );\n        const signedUrl = `${url.origin}/panel/api/file/${encodeURIComponent(key)}?token=${encodeURIComponent(token)}`;\n        return jsonResponse({ url: signedUrl });\n      }\n\n      if (url.pathname.startsWith(\"/panel/api/file/\") && request.method === \"GET\") {\n        const key = decodeURIComponent(url.pathname.replace(\"/panel/api/file/\", \"\"));\n        const token = url.searchParams.get(\"token\");\n        let payload = null;\n        let viaToken = false;\n        if (token) {\n          payload = await verifyFileToken(token, env);\n          viaToken = !!payload;\n          if (!payload) return jsonResponse({ error: \"Unauthorized\" }, 401);\n          if (pinRequired(env) && !payload.pin) return jsonResponse({ error: \"pin_required\" }, 403);\n        } else {\n          payload = await requireAccess(request, env);\n          if (!payload) return jsonResponse({ error: \"Unauthorized\" }, 401);\n          if (!verifyPin(request, env)) return jsonResponse({ error: \"pin_required\" }, 403);\n        }\n\n        const allowlist = parseAllowlist(env);\n        if (allowlist.length) {\n          const ip = clientIp(request);\n          if (!allowlist.includes(ip)) return jsonResponse({ error: \"Forbidden\" }, 403);\n        }\n\n        const obj = await env.PANEL_FILES.get(key);\n        if (!obj) return jsonResponse({ error: \"Not found\" }, 404);\n\n        const name = obj.customMetadata?.name || \"file.pdf\";\n        const download = url.searchParams.get(\"download\") === \"1\" || payload?.download;\n        const headers = new Headers();\n        obj.writeHttpMetadata(headers);\n        const origType = obj.customMetadata?.origType || headers.get(\"Content-Type\") || \"application/pdf\";\n        headers.set(\"Content-Type\", origType);\n        headers.set(\n          \"Content-Disposition\",\n          `${download ? \"attachment\" : \"inline\"}; filename=\\\"${name}\\\"`\n        );\n        headers.set(\"Cache-Control\", \"private, max-age=0, no-store\");\n        headers.set(\"Vary\", \"Cookie\");\n\n        let body = obj.body;\n        if (obj.customMetadata?.enc === \"1\") {\n          const iv = base64UrlDecode(obj.customMetadata?.iv || \"\");\n          const encrypted = await obj.arrayBuffer();\n          const decrypted = await decryptBuffer(encrypted, iv, env);\n          body = decrypted;\n        }\n\n        await logFileAccess(env, {\n          userId: payload?.sub || null,\n          key,\n          action: download ? \"download\" : \"view\",\n          ip: clientIp(request),\n          ua: request.headers.get(\"User-Agent\") || \"\",\n          viaToken,\n        });\n\n        return applySecurityHeaders(new Response(body, { headers }));\n      }\n\n      if (url.pathname.startsWith(\"/panel/api/file/\") && request.method === \"DELETE\") {\n        const key = decodeURIComponent(url.pathname.replace(\"/panel/api/file/\", \"\"));\n        await env.PANEL_FILES.delete(key);\n        const index = await readIndex(env);\n        await writeIndex(env, index.filter((i) => i.key !== key));\n        return jsonResponse({ ok: true });\n      }\n\n      return jsonResponse({ error: \"Not found\" }, 404);\n    }\n\n    const panelRes = await fetch(new Request(PAGES_ORIGIN + url.pathname + url.search, request));\n    return applySecurityHeaders(panelRes);\n  }\n}\n"],
  "mappings": "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",
  "names": ["encoder", "REFRESH_TTL", "ACCESS_TTL", "cookie", "quarterTry", "quarterUsd"]
}
